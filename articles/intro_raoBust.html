<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to raoBust • raoBust</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to raoBust">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">raoBust</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/intro_raoBust.html">Introduction to raoBust</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to raoBust</h1>
                        <h4 data-toc-skip class="author">Sarah
Teichman</h4>
            
            <h4 data-toc-skip class="date">2025-10-16</h4>
      

      <div class="d-none name"><code>intro_raoBust.Rmd</code></div>
    </div>

    
    
<p>We’ll start by installing <code>raoBust</code> if we haven’t already,
and then loading it.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># if (!require("remotes", quietly = TRUE))</span></span>
<span><span class="co">#     install.packages("remotes")</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># remotes::install_github("statdivlab/raoBust")</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">raoBust</span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 methods overwritten by 'geeasy':</span></span>
<span><span class="co">#&gt;   method       from   </span></span>
<span><span class="co">#&gt;   drop1.geeglm MESS   </span></span>
<span><span class="co">#&gt;   drop1.geem   MESS   </span></span>
<span><span class="co">#&gt;   plot.geeglm  geepack</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>raoBust</code> is an R package that implements robust Wald
tests and Rao (score) tests for generalized linear models. We like
robust tests because they are robust (retain error rate control) to many
forms of model misspecification. We especially like robust Rao tests
because they have strong error rate control in small samples.</p>
<p><code>raoBust</code> implements robust tests for coefficients in
Poisson GLMs (log link), Binomial GLMs (logit link), linear models
(identity link), and Multinomial GLMs (log link).</p>
</div>
<div class="section level2">
<h2 id="model-fitting">Model fitting<a class="anchor" aria-label="anchor" href="#model-fitting"></a>
</h2>
<div class="section level3">
<h3 id="glms">GLMs<a class="anchor" aria-label="anchor" href="#glms"></a>
</h3>
<p>We will demonstrate <code>raoBust</code> using the
<code>mtcars</code> dataset.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    mpg cyl disp  hp drat    wt  qsec vs am gear carb</span></span>
<span><span class="co">#&gt; Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4</span></span>
<span><span class="co">#&gt; Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4</span></span>
<span><span class="co">#&gt; Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1</span></span>
<span><span class="co">#&gt; Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1</span></span>
<span><span class="co">#&gt; Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2</span></span>
<span><span class="co">#&gt; Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span><span class="co">#&gt; 1          5.1         3.5          1.4         0.2  setosa</span></span>
<span><span class="co">#&gt; 2          4.9         3.0          1.4         0.2  setosa</span></span>
<span><span class="co">#&gt; 3          4.7         3.2          1.3         0.2  setosa</span></span>
<span><span class="co">#&gt; 4          4.6         3.1          1.5         0.2  setosa</span></span>
<span><span class="co">#&gt; 5          5.0         3.6          1.4         0.2  setosa</span></span>
<span><span class="co">#&gt; 6          5.4         3.9          1.7         0.4  setosa</span></span></code></pre></div>
<p>First, let’s consider fitting a Poisson GLM to estimate and test the
expected fold-difference in <code>mpg</code> associated with a one-unit
increase in horsepower, account for type of transmission. We choose
Poisson regression because we want to estimate a fold-difference in
means, and because we are using robust tests we will not worry about
whether we actually expect <code>mpg</code> measurements to follow a
Poisson distribution.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/glm_test.html">glm_test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">mpg</span> <span class="op">~</span> <span class="va">hp</span> <span class="op">+</span> <span class="va">am</span>, data <span class="op">=</span> <span class="va">mtcars</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = mpg ~ hp + am, data = mtcars, family = poisson(link = "log"))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficient estimates:</span></span>
<span><span class="co">#&gt;                 Estimate Non-robust Std Error Robust Std Error Lower 95% CI</span></span>
<span><span class="co">#&gt; (Intercept)  3.327082221         0.1151938176     0.0557891828  3.217737432</span></span>
<span><span class="co">#&gt; hp          -0.003110758         0.0006656492     0.0003679554 -0.003831938</span></span>
<span><span class="co">#&gt; am           0.234033015         0.0835981015     0.0479722881  0.140009058</span></span>
<span><span class="co">#&gt;             Upper 95% CI Non-robust Wald p Robust Wald p Robust Score p</span></span>
<span><span class="co">#&gt; (Intercept)  3.436427010     1.982292e-183  0.000000e+00   6.558146e-06</span></span>
<span><span class="co">#&gt; hp          -0.002389579      2.964427e-06  0.000000e+00   2.397949e-03</span></span>
<span><span class="co">#&gt; am           0.328056971      5.118157e-03  1.068933e-06   9.288962e-04</span></span></code></pre></div>
<p>Looking at the output, we can see our estimated fold-difference in
<code>mpg</code> associated with a one-unit increase in horsepower is
<code>exp(-0.003) = 0.997</code>, with a robust Rao test p-value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.002</mn><annotation encoding="application/x-tex">0.002</annotation></semantics></math>.
We can compare this to the results we would get if we ran a typical
<code>glm</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">mpg</span> <span class="op">~</span> <span class="va">hp</span> <span class="op">+</span> <span class="va">am</span>, data <span class="op">=</span> <span class="va">mtcars</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = mpg ~ hp + am, family = poisson(link = "log"), </span></span>
<span><span class="co">#&gt;     data = mtcars)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;               Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)  3.3270822  0.1151938  28.882  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; hp          -0.0031108  0.0006656  -4.673 2.96e-06 ***</span></span>
<span><span class="co">#&gt; am           0.2340330  0.0835981   2.800  0.00512 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for poisson family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 54.524  on 31  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 10.727  on 29  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: Inf</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span></code></pre></div>
<p>Here we see the same estimates, but <code>glm</code> does not give us
robust standard errors or robust Wald and Rao tests.</p>
</div>
<div class="section level3">
<h3 id="gees-accounting-for-clusters">GEEs, accounting for clusters<a class="anchor" aria-label="anchor" href="#gees-accounting-for-clusters"></a>
</h3>
<p>In <code>raoBust</code> we can also use a GEE framework to account
for clustered observations. Let’s add a cluster variable to
<code>mtcars</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, each <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/gee_test.html">gee_test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">mpg</span> <span class="op">~</span> <span class="va">hp</span> <span class="op">+</span> <span class="va">am</span>, data <span class="op">=</span> <span class="va">mtcars</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span>, id <span class="op">=</span> <span class="va">cluster</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in geelm(formula = mpg ~ hp + am, data = structure(list(mpg = c(21,  : </span></span>
<span><span class="co">#&gt;   could not find function "geelm"</span></span>
<span><span class="co">#&gt; Warning in gee_test(formula = mpg ~ hp + am, data = mtcars, family =</span></span>
<span><span class="co">#&gt; poisson(link = "log"), : GEE solver failed. Estimation will be done with a GLM,</span></span>
<span><span class="co">#&gt; which will provide consistent parameter estimates but will not be as efficient</span></span>
<span><span class="co">#&gt; as estimates from a GEE. Robust standard errors will be estimated using a</span></span>
<span><span class="co">#&gt; clustered jackknife procedure.</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 18.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 18.100000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 14.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 24.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 22.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 17.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 16.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 17.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 10.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 10.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 14.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 32.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 30.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 33.900000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.500000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.500000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 13.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 27.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 30.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 22.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 22.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 17.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 16.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 17.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 10.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 10.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 14.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 32.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 30.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 33.900000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.500000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.500000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 13.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 27.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 30.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 22.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 18.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 18.100000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 14.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 24.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 17.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 10.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 10.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 14.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 32.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 30.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 33.900000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.500000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.500000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 13.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 27.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 30.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 22.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 18.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 18.100000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 14.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 24.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 22.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 17.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 16.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 14.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 32.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 30.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 33.900000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.500000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.500000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 13.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 27.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 30.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 22.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 18.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 18.100000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 14.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 24.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 22.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 17.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 16.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 17.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 10.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 10.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.500000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.500000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 13.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 27.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 30.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 22.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 18.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 18.100000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 14.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 24.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 22.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 17.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 16.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 17.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 10.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 10.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 14.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 32.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 30.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 33.900000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 27.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 30.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 22.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 18.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 18.100000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 14.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 24.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 22.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 17.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 16.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 17.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 10.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 10.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 14.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 32.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 30.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 33.900000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.500000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.500000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 13.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 22.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 18.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 18.100000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 14.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 24.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 22.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 17.800000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 16.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 17.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 10.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 10.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 14.700000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 32.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 30.400000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 33.900000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 21.500000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.500000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 15.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 13.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 19.200000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 27.300000</span></span>
<span><span class="co">#&gt; Warning in dpois(y, mu, log = TRUE): non-integer x = 30.400000</span></span>
<span><span class="co">#&gt; Warning: Because estimation has been done with a GLM, there is no estimated</span></span>
<span><span class="co">#&gt; cluster correlation coefficient. Therefore the robust score test cannot be run.</span></span>
<span><span class="co">#&gt; In order to run a robust score test for this model, please input a</span></span>
<span><span class="co">#&gt; within-cluster correlation coefficient to use.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; gee_test(formula = mpg ~ hp + am, data = mtcars, family = poisson(link = "log"), </span></span>
<span><span class="co">#&gt;     id = cluster)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficient estimates:</span></span>
<span><span class="co">#&gt;                       Estimate Robust Std Error Lower 95% CI Upper 95% CI</span></span>
<span><span class="co">#&gt; (Intercept)        3.327082221     0.0889250810  3.152792264  3.501372177</span></span>
<span><span class="co">#&gt; hp                -0.003110758     0.0006219336 -0.004329726 -0.001891791</span></span>
<span><span class="co">#&gt; am                 0.234033015     0.0683527788  0.100064030  0.368001999</span></span>
<span><span class="co">#&gt; correlation:alpha           NA               NA           NA           NA</span></span>
<span><span class="co">#&gt;                   Robust Wald p Robust Score p</span></span>
<span><span class="co">#&gt; (Intercept)        0.000000e+00             NA</span></span>
<span><span class="co">#&gt; hp                 5.681147e-07             NA</span></span>
<span><span class="co">#&gt; am                 6.172955e-04             NA</span></span>
<span><span class="co">#&gt; correlation:alpha            NA             NA</span></span></code></pre></div>
<p>Again we have the same estimates, but different standard errors and
robust Wald and Rao test p-values once we account for clustering.</p>
</div>
<div class="section level3">
<h3 id="multinomial-models">Multinomial models<a class="anchor" aria-label="anchor" href="#multinomial-models"></a>
</h3>
<p>In <code>raoBust</code>, we have a function
<code><a href="../reference/multinom_test.html">multinom_test()</a></code> to run robust tests for multinomial
regression. Important arguments are <code>strong</code> and
<code>j</code>. When we set <code>strong = TRUE</code>, we test the
strong null hypothesis that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\beta_{kj} = 0</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
represents a covariate and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
represents a level of the outcome variable. This means that we’re
testing the hypothesis that all non-intercept coefficients are equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>.
When <code>strong = FALSE</code> then we must specify a outcome level to
test with the <code>j</code> argument. In this case, we test the
hypothesis that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\beta_{kj} = 0</annotation></semantics></math>
for the <code>j</code> specified and all covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.</p>
<p><code>multinom_test</code> takes in a <code>Y</code> matrix, with
<code>n</code> rows and <code>J</code> columns for a dataset with
<code>n</code> samples and a multi-category outcome with <code>J</code>
categories, and a design matrix <code>X</code> that includes metadata.
We will simulate data to demonstrate <code><a href="../reference/multinom_test.html">multinom_test()</a></code>
on.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>  <span class="co"># for reproducibility</span></span>
<span></span>
<span><span class="co"># design matrix: 30 samples x 2 covariates</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, each <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># coefficient matrix B: 3 rows x 5 columns</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">3</span> <span class="op">*</span> <span class="va">J</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">B</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">B</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">+</span> <span class="fl">3</span></span>
<span></span>
<span><span class="co"># generate Poisson outcomes</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="va">J</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">J</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">B</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">Y</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">lambda</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We can now fit our model. We’ll start by testing the strong null
hypothesis that all non-intercept coefficients are equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strong_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multinom_test.html">multinom_test</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">Y</span>, X <span class="op">=</span> <span class="va">X</span>, strong <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">strong_test</span><span class="op">$</span><span class="va">coef_tab</span></span>
<span><span class="co">#&gt;    Category   Covariate    Estimate Robust Std Error Lower 95% CI Upper 95% CI</span></span>
<span><span class="co">#&gt; 11        4           1 -1.52159024       0.14168311   -1.7992840  -1.24389645</span></span>
<span><span class="co">#&gt; 2         1           1 -1.19778008       0.10005117   -1.3938768  -1.00168340</span></span>
<span><span class="co">#&gt; 8         3           1 -1.13105847       0.11182994   -1.3502411  -0.91187582</span></span>
<span><span class="co">#&gt; 4         2 (intercept)  1.04369722       0.08435207    0.8783702   1.20902425</span></span>
<span><span class="co">#&gt; 7         3 (intercept)  0.93283338       0.08293878    0.7702764   1.09539040</span></span>
<span><span class="co">#&gt; 1         1 (intercept)  0.78509417       0.08361962    0.6212027   0.94898561</span></span>
<span><span class="co">#&gt; 5         2           1 -0.64777461       0.09662728   -0.8371606  -0.45838862</span></span>
<span><span class="co">#&gt; 9         3           2 -0.63990526       0.05227395   -0.7423603  -0.53745021</span></span>
<span><span class="co">#&gt; 12        4           2 -0.60215382       0.06820800   -0.7358390  -0.46846859</span></span>
<span><span class="co">#&gt; 10        4 (intercept)  0.47105039       0.12368367    0.2286349   0.71346592</span></span>
<span><span class="co">#&gt; 6         2           2 -0.13838624       0.03988563   -0.2165606  -0.06021185</span></span>
<span><span class="co">#&gt; 3         1           2 -0.04985085       0.04445023   -0.1369717   0.03727000</span></span>
<span><span class="co">#&gt;    Robust Wald p Robust Score p</span></span>
<span><span class="co">#&gt; 11  6.648178e-27             NA</span></span>
<span><span class="co">#&gt; 2   5.000849e-33             NA</span></span>
<span><span class="co">#&gt; 8   4.784250e-24             NA</span></span>
<span><span class="co">#&gt; 4   3.654085e-35             NA</span></span>
<span><span class="co">#&gt; 7   2.389181e-29             NA</span></span>
<span><span class="co">#&gt; 1   6.064411e-21             NA</span></span>
<span><span class="co">#&gt; 5   2.030015e-11             NA</span></span>
<span><span class="co">#&gt; 9   1.868292e-34             NA</span></span>
<span><span class="co">#&gt; 12  1.063748e-18             NA</span></span>
<span><span class="co">#&gt; 10  1.398072e-04             NA</span></span>
<span><span class="co">#&gt; 6   5.212790e-04             NA</span></span>
<span><span class="co">#&gt; 3   2.620759e-01             NA</span></span>
<span><span class="va">strong_test</span><span class="op">$</span><span class="va">test_stat</span></span>
<span><span class="co">#&gt; [1] 25.10367</span></span>
<span><span class="va">strong_test</span><span class="op">$</span><span class="va">p</span></span>
<span><span class="co">#&gt; [1] 0.001492897</span></span>
<span></span>
<span><span class="va">weak_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multinom_test.html">multinom_test</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">Y</span>, X <span class="op">=</span> <span class="va">X</span>, strong <span class="op">=</span> <span class="cn">FALSE</span>, j <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">weak_test</span><span class="op">$</span><span class="va">coef_tab</span></span>
<span><span class="co">#&gt;    Category   Covariate    Estimate Robust Std Error Lower 95% CI Upper 95% CI</span></span>
<span><span class="co">#&gt; 11        4           1 -1.52159024       0.14168311   -1.7992840  -1.24389645</span></span>
<span><span class="co">#&gt; 2         1           1 -1.19778008       0.10005117   -1.3938768  -1.00168340</span></span>
<span><span class="co">#&gt; 8         3           1 -1.13105847       0.11182994   -1.3502411  -0.91187582</span></span>
<span><span class="co">#&gt; 4         2 (intercept)  1.04369722       0.08435207    0.8783702   1.20902425</span></span>
<span><span class="co">#&gt; 7         3 (intercept)  0.93283338       0.08293878    0.7702764   1.09539040</span></span>
<span><span class="co">#&gt; 1         1 (intercept)  0.78509417       0.08361962    0.6212027   0.94898561</span></span>
<span><span class="co">#&gt; 5         2           1 -0.64777461       0.09662728   -0.8371606  -0.45838862</span></span>
<span><span class="co">#&gt; 9         3           2 -0.63990526       0.05227395   -0.7423603  -0.53745021</span></span>
<span><span class="co">#&gt; 12        4           2 -0.60215382       0.06820800   -0.7358390  -0.46846859</span></span>
<span><span class="co">#&gt; 10        4 (intercept)  0.47105039       0.12368367    0.2286349   0.71346592</span></span>
<span><span class="co">#&gt; 6         2           2 -0.13838624       0.03988563   -0.2165606  -0.06021185</span></span>
<span><span class="co">#&gt; 3         1           2 -0.04985085       0.04445023   -0.1369717   0.03727000</span></span>
<span><span class="co">#&gt;    Robust Wald p Robust Score p</span></span>
<span><span class="co">#&gt; 11  6.648178e-27             NA</span></span>
<span><span class="co">#&gt; 2   5.000849e-33             NA</span></span>
<span><span class="co">#&gt; 8   4.784250e-24             NA</span></span>
<span><span class="co">#&gt; 4   3.654085e-35             NA</span></span>
<span><span class="co">#&gt; 7   2.389181e-29             NA</span></span>
<span><span class="co">#&gt; 1   6.064411e-21             NA</span></span>
<span><span class="co">#&gt; 5   2.030015e-11             NA</span></span>
<span><span class="co">#&gt; 9   1.868292e-34             NA</span></span>
<span><span class="co">#&gt; 12  1.063748e-18             NA</span></span>
<span><span class="co">#&gt; 10  1.398072e-04             NA</span></span>
<span><span class="co">#&gt; 6   5.212790e-04             NA</span></span>
<span><span class="co">#&gt; 3   2.620759e-01             NA</span></span>
<span><span class="va">weak_test</span><span class="op">$</span><span class="va">test_stat</span></span>
<span><span class="co">#&gt; [1] 10.02201</span></span>
<span><span class="va">weak_test</span><span class="op">$</span><span class="va">p</span></span>
<span><span class="co">#&gt; [1] 0.006664209</span></span></code></pre></div>
<p>We can see that the strong test has a larger robust Rao test
statistic and smaller p-value, compared to the weak test. This makes
sense, as it tests a stronger hypothesis that is more likely to be false
(since it contains all possible weak hypotheses).</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Amy Willis, David Clausen, Sarah Teichman, Shirley Mathur.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
